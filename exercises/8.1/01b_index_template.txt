# ** EXAM OBJECTIVE: DATA MANAGEMENT **
# GOAL: Define and use an index template for a given pattern that satisfies a given set of requirements
# REQUIRED SETUP: (i) a running Elasticsearch cluster with at least one node and a Kibana instance, (ii) no index or index template that starts by `hamlet`
# Copy-paste the following instructions into your Kibana console, and work directly from there

# Create the index template `hamlet_template`, so that the template (i) matches any index that starts by "hamlet_" or "hamlet-", (ii) allocates one primary shard and no replicas for each matching index
# Create the indices `hamlet2` and `hamlet_test`
# Verify that only `hamlet_test` applies the settings defined in `hamlet_template`
# In one request, delete both `hamlet2` and `hamlet_test`
# Update `hamlet_template` by defining a mapping, so that (i) the mapping has three fields, named `speaker`, `line_number`, and `text_entry`, (ii) `speaker` and `line_number` map to a unanalyzed string, (iii) `text_entry` uses an "english" analyzer
# Create the index `hamlet-1` and add some documents by running the following _bulk command
PUT hamlet-1/_bulk
{"index":{"_index":"hamlet-1","_id":0}}
{"line_number":"1.1.1","speaker":"BERNARDO","text_entry":"Whos there?"}
{"index":{"_index":"hamlet-1","_id":1}}
{"line_number":"1.1.2","speaker":"FRANCISCO","text_entry":"Nay, answer me: stand, and unfold yourself."}
{"index":{"_index":"hamlet-1","_id":2}}
{"line_number":"1.1.3","speaker":"BERNARDO","text_entry":"Long live the king!"}
{"index":{"_index":"hamlet-1","_id":3}}
{"line_number":"1.2.1","speaker":"KING CLAUDIUS","text_entry":"Though yet of Hamlet our dear brothers death"}
# Verify that the mapping of `hamlet-1` is consistent with what defined in `hamlet_template`
# Update `hamlet_template` so as to reject any document having a field that is not defined in the mapping
# Verify that you cannot index the following document in `hamlet-1`
PUT hamlet-1/_doc
{
  "author": "Shakespeare"
}
# Delete all indices beginning with `hamlet`
# Delete all index templates beginning with `hamlet`
# Create a component template `hamlet-settings-comp`, so that the template allocates one primary shard and no replicas for each matching index
# Create a component template `hamlet-mapping-comp`, so that (i) the mapping of the template has three fields, named `speaker`, `line_number`, and `text_entry`, (ii) `speaker` and `line_number` map to a unanalysed string, (iii) `text_entry` uses an "english" analyzer
# Create a new index template, so that the template (i) matches any index that starts by "hamlet_" or "hamlet-", (ii) is composed of the component templates `hamlet-settings-comp`and `hamlet-mapping-comp`
# Create the indices `hamlet2` and `hamlet_test`
# Verify that only `hamlet_test` applies the settings defined in `hamlet_template`
# Delete all indices beginning with `hamlet`
# Delete all index templates beginning with `hamlet`
# Delete all component templates beginning with `hamlet`

